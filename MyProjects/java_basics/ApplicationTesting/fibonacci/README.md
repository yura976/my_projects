Цель практической работы
Научиться:

писать юнит-тесты с использованием библиотеки JUnit 5,
создавать тестовые классы-заглушки (моки) с помощью библиотеки Mockito при написании юнит-тестов,
тестировать слой доступа к данным Spring JPA с помощью testcontainers,
тестировать Spring MVC приложения.


Что входит в практическую работу
В этой практической работе вы напишете юнит-тесты и тесты, проверяющие работу API, для приложения, созданного с помощью фреймворка Spring Boot.

Задание 1. Юнит-тесты для класса FibonacciCalculator
Что нужно сделать
Напишите юнит-тесты для класса FibonacciCalculator. Используйте сценарии:

Калькулятор должен возвращать число из последовательности Фибоначчи по переданному порядковому номеру.
Калькулятор должен возвращать исключение, если переданный порядковый номер меньше 1.
Для порядковых номеров 1 и 2 калькулятор должен вернуть значение 1.

Задание 2. Юнит-тесты для класса FibonacciService
Что нужно сделать
Напишите юнит-тесты для класса FibonacciService. Используйте сценарии:

Сервис должен вернуть число Фибоначчи по переданному порядковому номеру. Убедитесь, что если число есть в БД, то результат берётся из БД, а не рассчитывается.
Сервис должен вернуть число Фибоначчи по переданному порядковому номеру. Убедитесь, что если числа нет в БД, то оно рассчитывается и сохраняется в БД.
Если переданный порядковый номер меньше 1, должно возвращаться исключение.

Задание 3. Тесты, проверяющие работу с БД, для класса FibonacciRepository
Что нужно сделать
Напишите тесты, проверяющие работу с базой данных, для класса FibonacciRepository. Используйте сценарии:

Новые числа Фибоначчи сохраняются в БД.
При поиске по порядковому номеру возвращается соответствующее число из БД.
При повторной вставке одного и того же числа в БД не возникает исключений и дубликатов.

Задание 4. Тесты, проверяющие работу API, для класса FibonacciController
Что нужно сделать
Напишите тесты, проверяющие работу API, для класса FibonacciController. Используйте сценарии:

При запросе по адресу /fibonacci/{index} с индексом больше 1 возвращается HTTP-ответ со статусом 200 и соответствующее число Фибоначчи в формате JSON.
При запросе по адресу /fibonacci/{index} с индексом меньше 1 возвращается HTTP-ответ со статусом 400 и соответствующим текстом ошибки.

Что оценивается
Все сценарии, перечисленные в задании, реализованы и выполняются успешно.
В задании 2 в тестах FibonacciService проверяется не только конечный результат операции, но и то, каким образом сервис использует FibonacciCalculator и FibonacciRepository. Например, если число рассчитывается в первый раз, то должен вызываться метод FibonacciRepository.save. А если число уже было сохранено до этого — метод вызываться не должен. Параметры, с которыми вызываются методы классов-моков, тоже нужно проверить.
При написании тестов использованы рекомендуемые библиотеки.
В задании 3 при тестировании БД в проверках не используется класс FibonacciRepository, вместо него должны использоваться другие методы доступа к БД.


Критерии оценки
Принято:

Все сценарии реализованы и успешно проходят.
При написании сценариев использованы рекомендуемые библиотеки.
На доработку:

Задание не выполнено или выполнено неточно.
Часть сценариев не реализована или в сценариях выполнены не все проверки.
